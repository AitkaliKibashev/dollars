(this.webpackJsonpdollars=this.webpackJsonpdollars||[]).push([[0],{48:function(e,t,n){},54:function(e,t,n){},59:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(16),c=n.n(r),s=(n(48),n(9)),o=n(10),i=n.n(o),u=n(11),l=n(5),j=(n(54),n.p+"static/media/dollars_logo.a3c0389c.jpg"),b=n(7),d=n(2),m=Object(b.b)((function(e){return{isAuth:e.auth.isAuth,user:e.auth.user}}))((function(e){var t=e.isAuth,n=e.user;return Object(d.jsxs)("header",{className:"header",children:[Object(d.jsx)("div",{className:"logo",children:Object(d.jsx)("img",{src:j,alt:"dollars"})}),Object(d.jsxs)("ul",{className:"link-list",children:[Object(d.jsx)("li",{className:"nav-link",children:Object(d.jsx)(s.b,{to:"/home",children:"Home"})}),Object(d.jsx)("li",{className:"nav-link",children:Object(d.jsx)(s.b,{to:"/about",children:"About"})}),Object(d.jsx)("li",{className:"nav-link",children:t?"Hello, Dollar ".concat(n.username):Object(d.jsx)(s.b,{to:"/login",children:"Login"})})]})]})})),O=(n(59),n(26)),h=n.n(O),p=n(43),f=n(3),g="SET_MESSAGES",x={messages:[]},v=function(e){return{type:g,payload:e}},N=n(13),w=n.n(N),S="http://127.0.0.1:8000/api",E=JSON.parse(localStorage.getItem("auth")),y=function(e){return w.a.post("".concat(S,"/messages"),e)},k={login:function(e){return w.a.post("".concat(S,"/login/"),e)},logout:function(){return w.a.post("".concat(S,"/logout/"),{},{headers:{Authorization:"token ".concat(E.token)}})},register:function(e){return w.a.post("".concat(S,"/register/"),e)}},A=Object(b.b)((function(e){return{messages:e.messages.messages,isAuth:e.auth.isAuth}}),(function(e){return{setMessages:function(t){return e(v(t))}}}))((function(e){var t=e.messages,n=e.setMessages,r=e.isAuth,c=Object(a.useState)(""),s=Object(l.a)(c,2),o=s[0],j=s[1];Object(a.useEffect)((function(){h.a.logToConsole=!1,new h.a("7e90421bdf9c4ad510d8",{cluster:"ap2"}).subscribe("chat").bind("messages",(function(e){n(e),console.log(e)}))}),[]);var b=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={message:t.target[0].value,username:"admin",send_date:Date.now()},e.next=4,y(n);case 4:j("");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)("main",{className:"main",children:Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)(m,{}),Object(d.jsx)("div",{className:"welcome",children:Object(d.jsx)("h1",{children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u043e\u0433\u043e \u043e\u0431\u0449\u0435\u0441\u0442\u0432\u0430 Dollars \u0410\u0442\u044b\u0440\u0430\u0443 - \u0433\u043b\u0430\u0432\u043d\u043e\u0435 \u043a\u043e\u043c\u043c\u0443\u043d\u0438\u043a\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e."})}),Object(d.jsx)("h2",{className:"chat-title",children:"Main Board"}),Object(d.jsx)("div",{className:"main-board",children:t.map((function(e){return Object(d.jsxs)("div",{className:"board-subject",children:[Object(d.jsxs)("div",{className:"board-header",children:["Name: ",e.username]}),Object(d.jsx)("div",{className:"board-body",children:e.message})]})}))}),r&&Object(d.jsxs)("form",{className:"message-form",onSubmit:function(e){return b(e)},children:[Object(d.jsx)("input",{name:"message-input",value:o,onChange:function(e){return j(e.target.value)}}),Object(d.jsx)("button",{children:"Send"})]})]})})})),C=(n(78),"TOGGLE_IS_AUTH"),I="SET_USER",_="REMOVE_USER",R="SET_ERROR",T={canEnter:!0,isAuth:!0,enterPassword:"babbooka",user:{},error:null},D=function(e){return{type:I,data:e}},U=function(e){return{type:R,error:e}},V=function(e){return{type:C,bool:e}},P=function(e){return function(){var t=Object(u.a)(i.a.mark((function t(n){var a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k.login(e);case 3:a=t.sent,console.log(a),200===a.status&&(r=Object(f.a)({},a.data),localStorage.setItem("auth",JSON.stringify(r)),n(V(!0)),n(D(a.data.user)),n(U(null))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(U("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c"));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},B=function(e){return function(){var t=Object(u.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k.register(e);case 3:return a=t.sent,t.next=6,k.createUserProfile({user:a.data.user.id});case 6:n(U(null)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),n(U("Email \u0438\u043b\u0438 \u041b\u043e\u0433\u0438\u043d \u0441 \u0442\u0430\u043a\u0438\u043c\u0438 \u0436\u0435 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},J=Object(b.b)((function(e){return{enterPassword:e.auth.enterPassword}}),(function(e){return{setCanEnter:function(t){return e(function(e){return{type:"SET_CAN_ENTER",payload:e}}(t))}}}))((function(e){var t=e.enterPassword,n=e.setCanEnter;return Object(d.jsxs)("div",{className:"index-main",children:[Object(d.jsx)("div",{className:"index-image-wrapper",children:Object(d.jsx)("img",{src:j,alt:"dollars"})}),Object(d.jsxs)("form",{className:"enter-form",onSubmit:function(e){return function(e){e.preventDefault(),e.target[0].value===t&&n(!0)}(e)},children:[Object(d.jsxs)("div",{className:"password-input",children:[Object(d.jsx)("label",{className:"password-label",htmlFor:"pw",children:"PASSWORD:"}),Object(d.jsx)("input",{type:"password",className:"enter-password",id:"pw"})]}),Object(d.jsx)("button",{className:"enter-btn",children:"ENTER"})]})]})})),L=(n(79),function(e){var t=e.setIsValid,n=Object(a.useState)(""),r=Object(l.a)(n,2),c=r[0],s=r[1],o=Object(a.useState)(!1),i=Object(l.a)(o,2),u=i[0],j=i[1],b=Object(a.useState)("\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),m=Object(l.a)(b,2),O=m[0],h=m[1];Object(a.useEffect)((function(){t(!O)}),[O]);return Object(d.jsxs)(d.Fragment,{children:[u&&O&&Object(d.jsx)("div",{className:"error-p",children:O}),Object(d.jsx)("div",{className:"field-wrapper",children:Object(d.jsx)("input",{onChange:function(e){return function(e){var t=e.target.value;s(t),/^\w+([-]?\w+)*@\w+([-]?\w+)*(\.\w{2,3})+$/.test(String(e.target.value).toLowerCase())?h(""):(h("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 email"),t||h("\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"))}(e)},value:c,onBlur:function(e){j(!0)},className:"common-input",name:"email",type:"email",placeholder:"Email"})})]})}),M=function(e){var t=e.setIsValid,n=Object(a.useState)(""),r=Object(l.a)(n,2),c=r[0],s=r[1],o=Object(a.useState)(!1),i=Object(l.a)(o,2),u=i[0],j=i[1],b=Object(a.useState)("\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),m=Object(l.a)(b,2),O=m[0],h=m[1];Object(a.useEffect)((function(){t(!O)}),[O]);return Object(d.jsxs)(d.Fragment,{children:[u&&O&&Object(d.jsx)("div",{className:"error-p",children:O}),Object(d.jsx)("div",{className:"field-wrapper",children:Object(d.jsx)("input",{onChange:function(e){return function(e){var t=e.target.value;s(t),t.length>30||t.length<3?h("\u041b\u043e\u0433\u0438\u043d \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435 ".concat(3," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0438 \u0431\u043e\u043b\u044c\u0448\u0435 ").concat(30," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")):h("")}(e)},value:c,onBlur:function(e){j(!0)},className:"common-input",name:"login",type:"text",placeholder:"\u041b\u043e\u0433\u0438\u043d"})})]})},F=function(e){var t=e.setIsValid,n=Object(a.useState)(""),r=Object(l.a)(n,2),c=r[0],s=r[1],o=Object(a.useState)(!1),i=Object(l.a)(o,2),u=i[0],j=i[1],b=Object(a.useState)("\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),m=Object(l.a)(b,2),O=m[0],h=m[1];Object(a.useEffect)((function(){t(!O)}),[O]);return Object(d.jsxs)(d.Fragment,{children:[u&&O&&Object(d.jsx)("div",{className:"error-p",children:O}),Object(d.jsx)("div",{className:"field-wrapper",children:Object(d.jsx)("input",{onChange:function(e){return function(e){var t=e.target.value;s(t),t.length<8||t.length>30?(h("\u041f\u0430\u0440\u043e\u043b\u044c \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435 ".concat(8," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0438 \u0431\u043e\u043b\u044c\u0448\u0435 ").concat(30," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")),t||h("\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c")):h("")}(e)},value:c,onBlur:function(e){j(!0)},className:"common-input",name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"})})]})},G=Object(b.b)((function(e){return{loginError:e.auth.error}}),{loginUser:P,registerUser:B})((function(e){var t=e.loginError,n=e.loginUser,r=e.registerUser,c=Object(a.useState)(!1),s=Object(l.a)(c,2),o=(s[0],s[1]),i=Object(a.useState)("login"),u=Object(l.a)(i,2),j=u[0],b=u[1];return Object(d.jsx)("main",{className:"main",children:Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)(m,{}),Object(d.jsx)("div",{className:"welcome_login",children:Object(d.jsx)("h1",{children:"register"===j?"Register":"Login"})}),t&&Object(d.jsx)("p",{className:"error-p",children:t}),Object(d.jsxs)("form",{className:"auth-form",onSubmit:function(e){return function(e){var t;e.preventDefault(),console.log("ok");var a=e.target[0].value,c=e.target[1].value,s=null===(t=e.target[2])||void 0===t?void 0:t.value,o={username:a,password:c};"login"===j?n(o):r(Object(f.a)(Object(f.a)({},o),{},{email:s}))}(e)},children:[Object(d.jsx)(M,{setIsValid:o}),"register"===j&&Object(d.jsx)(L,{setIsValid:o}),Object(d.jsx)(F,{setIsValid:o}),Object(d.jsx)("button",{className:"common-btn",children:"register"===j?"Register":"Login"})]}),Object(d.jsx)("p",{className:"helper_text",children:"register"===j?"\u0415\u0441\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442?":"\u041d\u0435\u0442 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430?"}),Object(d.jsx)("button",{className:"switch-btn",onClick:function(){b("login"===j?"register":"login")},children:"register"===j?"\u0412\u043e\u0439\u0442\u0438":"\u0421\u0442\u0430\u043d\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u043e\u0431\u0449\u0435\u0441\u0442\u0432\u0430"})]})})})),H=[{path:"/",Component:J}],z=[{path:"/home",Component:A},{path:"/login",Component:G}],W=Object(b.b)((function(e){return{canEnter:e.auth.canEnter}}))((function(e){return e.canEnter?Object(d.jsxs)(s.e,{children:[z.map((function(e){var t=e.path,n=e.Component;return Object(d.jsx)(s.d,{path:t,component:n,exact:!0},t)})),Object(d.jsx)(s.c,{to:"/home"})]}):Object(d.jsxs)(s.e,{children:[H.map((function(e){var t=e.path,n=e.Component;return Object(d.jsx)(s.d,{path:t,component:n,exact:!0},t)})),Object(d.jsx)(s.c,{to:"/"})]})})),$=Object(b.b)((function(e){return{}}),{checkIsAuth:function(){return function(){var e=Object(u.a)(i.a.mark((function e(t){var n,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("auth")){e.next=4;break}return t(V(!1)),e.abrupt("return",null);case 4:if(a=JSON.parse(n),r=new Date(a.expiry),!((new Date).getTime()>r.getTime())){e.next=11;break}return localStorage.removeItem("auth"),t(V(!1)),e.abrupt("return",null);case 11:t(V(!0)),t(D(a.user));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})((function(e){var t=e.checkIsAuth;return Object(a.useEffect)((function(){t()}),[]),Object(d.jsx)(s.a,{children:Object(d.jsx)(W,{})})})),q=n(21),K=n(42),Q=Object(q.b)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return Object(f.a)(Object(f.a)({},e),{},{isAuth:t.payload});case I:return Object(f.a)(Object(f.a)({},e),{},{user:t.data});case _:return Object(f.a)(Object(f.a)({},e),{},{user:{}});case R:return Object(f.a)(Object(f.a)({},e),{},{error:t.error});default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;return t.type===g?Object(f.a)(Object(f.a)({},e),{},{messages:[].concat(Object(p.a)(e.messages),[t.payload])}):e}}),X=Object(q.c)(Q,Object(q.a)(K.a));c.a.render(Object(d.jsx)(b.a,{store:X,children:Object(d.jsx)($,{})}),document.getElementById("root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.3eb0a977.chunk.js.map